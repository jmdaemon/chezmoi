#!/bin/bash

show_usage() {
    echo 'Usage: find_older [date] [num_results]
    [date]          The date formatted as YYYY-MM-DD
    [num_results]   The number of desired results
    '
}
find_older() {
    date=$1
    num_results=$2
    find . -not -newermt $date -ls | tr -s ' '  | awk -v OFS='\t' '{print $6,$7,$8,$9,$10,$11}' | head -n $num_results
}

is_valid() {
    re=$1
    str=$1
    [[ $str =~ $re ]] && true || false 
}

is_valid_date() {
    is_valid "^[0-9]{4}\-[0-9]{2}\-[0-9]{2}" 
}

is_valid_num() {
    is_valid "^[0-9]+" 
}

if [[ -z $1 || -z $2 ]]; then
    show_usage
else
    if [[ $(is_valid_date $1) -eq true && $(is_valid_num $2) -eq true ]]; then
        find_older $1 $2
    fi
fi
